# Topic Generator

This is a Java program that generates topics for public Dockstore entries using OpenAI's gpt-3.5-turbo-16k AI model.

The [entries.csv](entries.csv) file contains the TRS ID and default versions of public Dockstore entries to generate topics for. The [results](results) directory contains the generated topics for those entries from running the topic generator. 

## Setup

### Configuration file

Create a configuration file like the following. A template `metrics-aggregator.config` file can be found [here](templates/topic-generator.config).

```
[dockstore]
server-url: <Dockstore server url>
token: <Dockstore admin or curator token>

[ai]
openai-api-key: <OpenAI API key>
```

**Required:**
- `server-url`: The Dockstore server URL that's used to send API requests to.
    - Examples:
        - `https://qa.dockstore.org/api`
        - `https://staging.dockstore.org/api`
        - `https://dockstore.org/api`
- `token`: The Dockstore token of an admin or curator. This token is used to upload topics to the webservice.
- `openai-api-key`: The OpenAI API key required for using the OpenAI APIs. See https://platform.openai.com/docs/api-reference/authentication for more details. This is used to generate topics.

## Running the program

```
Usage: <main class> [options] [command] [command options]
  Options:
    -c, --config
      The config file path.
      Default: ./topic-generator.config
    --help
      Prints help for topicgenerator
  Commands:
    generate-topics      Generate topics for public Dockstore entries using 
            AI. Use the upload-topics command to upload these topics to 
            Dockstore. 
      Usage: generate-topics [options]
        Options:
          -e, --entries
            The file path to the CSV file containing the TRS ID, and version 
            name of the entries to generate topics for. The first line of the 
            file should contain the CSV fields: trsID,version
            Default: ./entries.csv

    upload-topics      Upload AI topics, generated by the generate-topics 
            command, for public Dockstore entries.
      Usage: upload-topics [options]
        Options:
        * -ai, --aiTopics
            The file path to the CSV file containing the TRS ID, and AI topics 
            of the entries to upload topics for. The first line of the file 
            should contain the CSV fields: trsId,aiTopic. The output file 
            generated by the generate-topics command can be used as the 
            argument.
```

### generate-topics

**Using the default configuration file path and entries input path:**

`java -jar target/topicgenerator-*-SNAPSHOT.jar generate-topics`

**Using a custom configuration file path and custom entries input path:**

`java -jar target/topicgenerator-*-SNAPSHOT.jar --config my-custom-config generate-topics --entries my-custom-entries.csv`

### upload-topics

This command is meant to be used to upload the AI topics generated by the [generate-topics](#generate-topics) command.

**Using the default configuration file path and a custom AI topics input path:**

`java -jar target/topicgenerator-*-SNAPSHOT.jar upload-topics --aiTopics generated-ai-topics.csv`

**Using a custom configuration file path and AI topics input path:**

`java -jar target/topicgenerator-*-SNAPSHOT.jar --config my-custom-config upload-topics --aiTopics generated-ai-topics.csv`